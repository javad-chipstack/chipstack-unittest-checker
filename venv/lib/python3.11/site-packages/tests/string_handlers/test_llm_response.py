"""Test module for chipstack_common.string_handlers.llm_response"""

from chipstack_common.string_handlers.llm_response import (
    remove_backtick_block,
    standardize_code,
)


def test_remove_backticks_verilog():
    code_block = """```verilog
some verilog code
```
Yep, that's code!"""
    expected = "some verilog code\n\nYep, that's code!"
    assert remove_backtick_block(code_block) == expected


def test_remove_backticks_systemverilog():
    code_block = """```systemverilog
some system verilog code
```
Yep, that's code!"""
    expected = "some system verilog code\n\nYep, that's code!"
    assert remove_backtick_block(code_block) == expected


def test_remove_backticks_json():
    code_block = """```json
{"some": "json"}
```
Yep, that's JSON!"""
    expected = '{"some": "json"}\n\nYep, that\'s JSON!'
    assert remove_backtick_block(code_block) == expected


def test_remove_multiple_backticks():
    code_block = """```verilog
this is verilog
```
```systemverilog
this is system verilog
```
```json
{"this": "json"}
```
whew!
"""
    expected = """this is verilog


this is system verilog


{"this": "json"}

whew!"""
    assert remove_backtick_block(code_block) == expected


def test_standardize_code():
    code = """
// This is a comment

    module some_module;


"""
    expected = "module some_module;"
    assert standardize_code(code) == expected
