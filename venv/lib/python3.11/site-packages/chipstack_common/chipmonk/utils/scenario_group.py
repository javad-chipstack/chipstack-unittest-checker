from enum import Enum
from typing import List, Optional


def _render_ports(ports: List[str]) -> str:
    return "\n- ".join([f"`{p}`" for p in ports])


def _render_reset_ports(reset_ports: List[str]) -> str:
    return "## Reset Ports:\n- " + _render_ports(reset_ports)


def _render_output_ports(output_ports: List[str]) -> str:
    return "## Output Ports:\n- " + _render_ports(output_ports)


def _render_input_ports(input_ports: List[str]) -> str:
    return "## Input Ports:\n- " + _render_ports(input_ports)


class ScenarioGroup(Enum):

    RESET_OUTPUT = "reset_output"
    INPUT_OUTPUT = "input_output"
    ONLY_OUTPUT = "only_output"
    NO_PORT_OR_HAS_INTERNAL_PORT = "no_port_or_has_internal_port"

    def port_details(
        self, input_ports: List[str], output_ports: List[str], reset_ports: List[str]
    ) -> str:
        match self:
            case ScenarioGroup.RESET_OUTPUT:
                return (
                    _render_reset_ports(reset_ports)
                    + "\n\n"
                    + _render_output_ports(output_ports)
                )
            case ScenarioGroup.INPUT_OUTPUT:
                return (
                    _render_input_ports(input_ports)
                    + "\n\n"
                    + _render_output_ports(output_ports)
                )
            case ScenarioGroup.ONLY_OUTPUT:
                return _render_output_ports(output_ports)
            case _:
                return ""

    def instructions(self) -> Optional[str]:
        match self:
            case ScenarioGroup.RESET_OUTPUT:
                return "Write scenarios that test the reset behavior of the output ports of the design. Here are the reset ports and output ports of the design:"
            case ScenarioGroup.INPUT_OUTPUT:
                return "Write scenarios that test the end-to-end functionality of the output ports of the design when the given input ports are driven. Here are the input ports and output ports of the design:"
            case ScenarioGroup.ONLY_OUTPUT:
                return "Write scenarios that tests the main-functionality of the given output ports of the design. Here are the output ports of the design:"
            case _:
                return None
